import{D as f,a as p}from"./DocsPageHeader-BBF35W9f.js";import{D as o}from"./DocsCallout-CN2pqXu-.js";import{D as v}from"./DocsLinkCard-DOYvFq2m.js";import{D as t}from"./DocsFeatureCard-BlCLAof0.js";import{u as g}from"./useDocHeadings-By33_tDs.js";import{d as u,i as y,c as h,b as s,a as i,k as n,w as r,m as a,r as m,o as b}from"./index-DrKSq3n4.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"docs-article"},k={class:"docs-content"},R={class:"docs-grid docs-grid-3"},S={class:"docs-grid docs-grid-2"},j={class:"docs-grid docs-grid-3"},C=u({__name:"LiveRecordingOverviewPage",setup(L){const{setHeadings:d}=g(),c=[{id:"principle",text:"The Principle",level:2},{id:"architecture",text:"Architecture Diagram",level:2},{id:"jeffrey-cli",text:"Jeffrey CLI",level:2},{id:"profiler-settings-hierarchy",text:"Profiler Settings Hierarchy",level:2},{id:"sessions",text:"Recording Sessions",level:2},{id:"repository-visualization",text:"Repository Visualization",level:2}];return y(()=>{d(c)}),(P,e)=>{const l=m("router-link");return b(),h("article",J,[s(f,{title:"Live Recording Overview",icon:"bi bi-broadcast-pin"}),i("div",k,[e[7]||(e[7]=i("p",null,"Live Recording enables continuous profiling by sharing a mounted disk between your Java services and Jeffrey. This approach eliminates manual file transfers and provides real-time visibility into application performance.",-1)),e[8]||(e[8]=i("h2",{id:"principle"},"The Principle",-1)),e[9]||(e[9]=i("p",null,"The core concept behind Live Recording is simple: services and Jeffrey share the same mounted storage.",-1)),i("div",R,[s(t,{icon:"bi bi-hdd-network",title:"Shared Storage",description:"Services and Jeffrey mount the same storage volume (NFS, PVC in Kubernetes, or local disk).",layout:"vertical"}),s(t,{icon:"bi bi-arrow-right-circle",title:"Services Write",description:"Java applications emit JFR recordings and artifacts to a specified directory structure.",layout:"vertical"}),s(t,{icon:"bi bi-eye",title:"Jeffrey Reads",description:"Jeffrey monitors the directories and automatically discovers new recordings for analysis.",layout:"vertical"})]),s(o,{type:"tip"},{default:r(()=>[...e[0]||(e[0]=[i("strong",null,"No manual transfers:",-1),a(" Since both services and Jeffrey access the same storage, there's no need to manually copy, upload, or transfer JFR files. Analysis can begin as soon as recordings are created. ",-1)])]),_:1}),e[10]||(e[10]=i("h2",{id:"architecture"},"Architecture Diagram",-1)),e[11]||(e[11]=i("p",null,"The following diagram illustrates the Live Recording architecture:",-1)),e[12]||(e[12]=i("div",{class:"docs-code-block"},[i("pre",null,`┌───────────────────────────────────────────────────────────────────────────┐
│                           SHARED MOUNTED STORAGE                          │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │  /recordings                                                        │  │
│  │    ├── workspace-1/                                                 │  │
│  │    │     └── project-a/                                             │  │
│  │    │           ├── session-001/  (recordings, artifacts, metadata)  │  │
│  │    │           └── session-002/                                     │  │
│  │    └── profiler-settings.json                                       │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────────────┘
          ▲                                           ▲
          │ writes                                    │ reads
          │                                           │
┌─────────┴─────────┐                        ┌────────┴────────┐
│    SERVICES       │                        │     JEFFREY     │
│  (Java Apps)      │                        │                 │
│                   │                        │  - Watches dirs │
│  - Jeffrey CLI    │                        │  - Parses JFR   │
│  - Async-Profiler │                        │  - Visualizes   │
└───────────────────┘                        └─────────────────┘`)],-1)),e[13]||(e[13]=i("h2",{id:"jeffrey-cli"},"Jeffrey CLI",-1)),e[14]||(e[14]=i("p",null,"Jeffrey CLI is a lightweight Java library that configures your services for Live Recording. Jeffrey can provide the necessary components on the shared disk for services to use.",-1)),e[15]||(e[15]=i("h3",null,"Provided Components",-1)),e[16]||(e[16]=i("p",null,"The official Jeffrey container includes these components that can be copied to shared storage:",-1)),i("div",S,[s(t,{icon:"bi bi-file-earmark-binary",title:"Async-Profiler Library",description:"Native profiling library (libasyncProfiler.so) for capturing CPU, allocation, and lock events.",color:"orange"}),s(t,{icon:"bi bi-file-earmark-zip",title:"Jeffrey CLI JAR",description:"Java library that reads profiler configuration and sets up the JVM arguments for profiling.",color:"orange"})]),e[17]||(e[17]=i("p",null,"To copy these libraries to shared storage, configure the following properties:",-1)),e[18]||(e[18]=i("div",{class:"docs-code-inline"},[i("code",null,[a("jeffrey.copy-libs.enabled=true"),i("br"),a("jeffrey.copy-libs.target=${jeffrey.home.dir}/libs")])],-1)),e[19]||(e[19]=i("p",null,"Jeffrey CLI and Async-Profiler can then be referenced from the target directory by your services.",-1)),s(o,{type:"info"},{default:r(()=>[...e[1]||(e[1]=[i("strong",null,"Alternative setup:",-1),a(" If you're not using the official Jeffrey container, you'll need to provide the Async-Profiler library and Jeffrey CLI JAR through other means (e.g., baking them into your service images or mounting them separately). ",-1)])]),_:1}),e[20]||(e[20]=n('<h3 data-v-400ec6f5>Environment Variable Configuration</h3><p data-v-400ec6f5>Jeffrey CLI generates the final JVM configuration and can output it to one of two environment variables:</p><div class="docs-grid docs-grid-2" data-v-400ec6f5><div class="docs-card docs-card-subtle" data-v-400ec6f5><div class="docs-card-body" data-v-400ec6f5><div class="env-header" data-v-400ec6f5><code data-v-400ec6f5>JEFFREY_PROFILER_CONFIG</code><span class="docs-badge docs-badge-warning" data-v-400ec6f5>Manual</span></div><p data-v-400ec6f5>The configuration value needs to be manually placed on the command-line when starting the JVM.</p></div></div><div class="docs-card docs-card-subtle" data-v-400ec6f5><div class="docs-card-body" data-v-400ec6f5><div class="env-header" data-v-400ec6f5><code data-v-400ec6f5>JDK_JAVA_OPTIONS</code><span class="docs-badge docs-badge-success" data-v-400ec6f5>Automatic</span></div><p data-v-400ec6f5>Automatically loaded by the JVM at startup - no manual intervention required.</p></div></div></div>',3)),s(v,{to:"/docs/cli/configuration",icon:"bi bi-terminal",title:"Jeffrey CLI Configuration",description:"Learn about HOCON configuration files, environment variable options, and how to set up profiling for your services."}),e[21]||(e[21]=n('<h3 data-v-400ec6f5>Metadata File</h3><p data-v-400ec6f5>For each recording session, Jeffrey CLI creates a JSON metadata file containing:</p><ul data-v-400ec6f5><li data-v-400ec6f5><strong data-v-400ec6f5>Session ID</strong> - Unique identifier for the recording session</li><li data-v-400ec6f5><strong data-v-400ec6f5>Project information</strong> - Which project this session belongs to</li><li data-v-400ec6f5><strong data-v-400ec6f5>Timestamp</strong> - When the session started</li><li data-v-400ec6f5><strong data-v-400ec6f5>Configuration</strong> - Profiler settings used for this session</li></ul><h2 id="profiler-settings-hierarchy" data-v-400ec6f5>Profiler Settings Hierarchy</h2><p data-v-400ec6f5>Jeffrey propagates profiler settings to the shared storage in a <code data-v-400ec6f5>.settings</code> folder at each level. Jeffrey CLI loads these settings when initializing a profiling session.</p><div class="hierarchy-diagram" data-v-400ec6f5><div class="hierarchy-level global" data-v-400ec6f5><div class="level-header" data-v-400ec6f5><i class="bi bi-globe" data-v-400ec6f5></i><span data-v-400ec6f5>Global Settings</span><span class="docs-badge docs-badge-default" data-v-400ec6f5>Default</span></div><p data-v-400ec6f5>Base configuration applied to all workspaces and projects</p><code class="level-path" data-v-400ec6f5>&lt;jeffrey-home&gt;/.settings/</code></div><div class="hierarchy-arrow" data-v-400ec6f5><i class="bi bi-arrow-down" data-v-400ec6f5></i></div><div class="hierarchy-level workspace" data-v-400ec6f5><div class="level-header" data-v-400ec6f5><i class="bi bi-folder2" data-v-400ec6f5></i><span data-v-400ec6f5>Workspace Settings</span><span class="docs-badge docs-badge-primary" data-v-400ec6f5>Override</span></div><p data-v-400ec6f5>Workspace-specific settings that override global defaults</p><code class="level-path" data-v-400ec6f5>&lt;jeffrey-home&gt;/workspaces/&lt;workspace-id&gt;/.settings/</code></div><div class="hierarchy-arrow" data-v-400ec6f5><i class="bi bi-arrow-down" data-v-400ec6f5></i></div><div class="hierarchy-level project" data-v-400ec6f5><div class="level-header" data-v-400ec6f5><i class="bi bi-folder" data-v-400ec6f5></i><span data-v-400ec6f5>Project Settings</span><span class="docs-badge docs-badge-primary" data-v-400ec6f5>Override</span></div><p data-v-400ec6f5>Project-specific settings with highest priority</p><code class="level-path" data-v-400ec6f5>&lt;jeffrey-home&gt;/workspaces/&lt;workspace-id&gt;/&lt;project-name&gt;/.settings/</code></div></div>',6)),s(o,{type:"info"},{default:r(()=>[...e[2]||(e[2]=[i("strong",null,"Settings inheritance:",-1),a(" Jeffrey CLI merges settings from all levels, with more specific levels overriding parent settings. This allows you to set global defaults while customizing specific workspaces or projects as needed. ",-1)])]),_:1}),e[22]||(e[22]=n(`<h2 id="sessions" data-v-400ec6f5>Recording Sessions</h2><p data-v-400ec6f5>A <strong data-v-400ec6f5>session</strong> represents a single application execution. Each time your application starts, a new session folder is created.</p><div class="docs-structure-block" data-v-400ec6f5><div class="docs-structure-header" data-v-400ec6f5><i class="bi bi-folder-check" data-v-400ec6f5></i><h4 data-v-400ec6f5>Session Folder Structure</h4></div><div class="docs-structure-body" data-v-400ec6f5><pre data-v-400ec6f5>session-001/
├── recording-1.jfr      # JFR recording chunks
├── recording-2.jfr
├── recording-3.jfr
├── perf-counters.json   # Performance counters (session end marker)
└── metadata.json        # Session metadata</pre></div></div><p data-v-400ec6f5>Key points about sessions:</p><ul data-v-400ec6f5><li data-v-400ec6f5><strong data-v-400ec6f5>Application restart = New session</strong> - Each application restart creates a new session folder</li><li data-v-400ec6f5><strong data-v-400ec6f5>Multiple JFR chunks</strong> - Long-running applications produce multiple recording files over time</li><li data-v-400ec6f5><strong data-v-400ec6f5>Session markers</strong> - Artifacts like <code data-v-400ec6f5>perf-counters.json</code> indicate when a session has finished</li></ul>`,5)),s(o,{type:"tip"},{default:r(()=>[...e[3]||(e[3]=[i("strong",null,"Session detection:",-1),a(" Jeffrey uses the presence of ",-1),i("code",null,"perf-counters.json",-1),a(" to detect when a session has finished. This allows for immediate analysis once profiling stops. ",-1)])]),_:1}),e[23]||(e[23]=i("h2",{id:"repository-visualization"},"Repository Visualization",-1)),i("p",null,[e[5]||(e[5]=a("Jeffrey watches session folders for each project and displays them in the ",-1)),s(l,{to:"/docs/concepts/projects/repository"},{default:r(()=>[...e[4]||(e[4]=[a("Repository",-1)])]),_:1}),e[6]||(e[6]=a(" page.",-1))]),i("div",j,[s(t,{icon:"bi bi-collection",title:"Session Overview",description:"View all recording sessions for a project, with status indicators showing active or finished state.",color:"green",layout:"vertical"}),s(t,{icon:"bi bi-clock-history",title:"Timeline View",description:"See when sessions started, their duration, and how many recordings each session contains.",color:"green",layout:"vertical"}),s(t,{icon:"bi bi-file-earmark-play",title:"Recording Actions",description:"Merge selected JFR chunks, download recordings, or create profiles for detailed analysis.",color:"green",layout:"vertical"})]),e[24]||(e[24]=i("p",null,"The Repository provides a central place to manage all live recording data, from viewing session status to creating profiles for flame graph analysis.",-1))]),s(p)])}}}),E=w(C,[["__scopeId","data-v-400ec6f5"]]);export{E as default};
